\pgfdeclareshape{3x3template}{
  \anchor{center}{\pgfpointorigin} % within the node, (0,0) is the center

  \anchor{text} % this is used to center the text in the node
  {\pgfpoint{-.5\wd\pgfnodeparttextbox}{-.5\ht\pgfnodeparttextbox}}

  \savedanchor\icpina{\pgfpoint{-9mm}{+10mm}} % pin 1
  \anchor{1}{\icpina}
  \savedanchor\icpind{\pgfpoint{-9mm}{0mm}} % pin 2
  \anchor{2}{\icpind}
  \savedanchor\icpine{\pgfpoint{-9mm}{-10mm}} % pin 3
  \anchor{3}{\icpine}
  \savedanchor\icpinh{\pgfpoint{+9mm}{-10mm}} % pin 4
  \anchor{4}{\icpinh}
  \savedanchor\icpinh{\pgfpoint{+9mm}{0mm}} % pin 5
  \anchor{5}{\icpinh}
  \savedanchor\icpinh{\pgfpoint{+9mm}{+10mm}} % pin 6
  \anchor{6}{\icpinh}

  \foregroundpath{ % border and pin numbers are drawn here
    \pgfsetlinewidth{0.03cm}
    \pgfpathrectanglecorners{\pgfpoint{6mm}{15mm}}{\pgfpoint{-6mm}{-15mm}}
    \pgfusepath{draw} %draw rectangle
    \pgfsetlinewidth{0.02cm}
    \pgfmoveto{\pgfpoint{-.3cm}{15mm}}
    \pgfpatharc{-180}{0}{.3cm}
    \pgfusepath{draw} %draw semicircle
    % Pin labels
    \pgftext[left,at={\pgfpoint{-4.5mm}{+10mm}}]{\scriptsize $1$}
    \pgftext[left,at={\pgfpoint{-4.5mm}{0mm}}]{\scriptsize $2$}
    \pgftext[left,at={\pgfpoint{-4.5mm}{-10mm}}]{\scriptsize $3$}
    \pgftext[right,at={\pgfpoint{+4.5mm}{-10mm}}]{\scriptsize $4$}
    \pgftext[right,at={\pgfpoint{+4.5mm}{0mm}}]{\scriptsize $5$}
    \pgftext[right,at={\pgfpoint{+4.5mm}{+10mm}}]{\scriptsize $6$}
    % Pin wires
    \pgfsetlinewidth{0.01cm}
    \draw
      (-9mm, 10mm) -- (-6mm, +10mm) %1
      (-9mm, 0mm) -- (-6mm, 0mm) %2
      (-9mm, -10mm) -- (-6mm, -10mm) %3
      (+6mm, -10mm) -- (+9mm, -10mm) %4
      (+6mm, 0mm) -- (+9mm, 0mm) %5
      (+6mm, +10mm) -- (+9mm, +10mm) %6
    ;
    %Clock input triangle in pin 2
    \pgfsetlinewidth{0.02cm}
    \draw
      (-6mm, 1mm) -- (-4.5mm, 0mm)
      (-4.5mm, 0mm) -- (-6mm, -1mm)
    ;
    %Clock input triangle in pin 3
    \pgfsetlinewidth{0.02cm}
    \draw
      (-6mm, -11mm) -- (-4.5mm, -10mm)
      (-4.5mm, -10mm) -- (-6mm, -9mm)
    ;
    %Low-active bubbles, delete if unnecessary
    \pgfsetlinewidth{0.02cm}
    \fill[color=white] (-6.9mm, +10mm) circle (.7mm); %1 is low-active
    \draw (-6.9mm, +10mm) circle (.8mm);
    \fill[color=white] (-6.9mm, 0mm) circle (.7mm); %2 is low-active
    \draw (-6.9mm, 0mm) circle (.8mm);
    \fill[color=white] (-6.9mm, -10mm) circle (.7mm); %3 is low-active
    \draw (-6.9mm, -10mm) circle (.8mm);
    \fill[color=white] (+6.9mm, -10mm) circle (.7mm); %4 is low-active
    \draw (+6.9mm, -10mm) circle (.8mm);
    \fill[color=white] (+6.9mm, 0mm) circle (.7mm); %5 is low-active
    \draw (+6.9mm, 0mm) circle (.8mm);
    \fill[color=white] (+6.9mm, +10mm) circle (.7mm); %6 is low-active
    \draw (+6.9mm, +10mm) circle (.8mm);
  }
}